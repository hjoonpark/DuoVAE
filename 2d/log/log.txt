2022-09-29 14:38:32 INFO =============== START ===============
2022-09-29 14:38:32 INFO   model  : duovae
2022-09-29 14:38:32 INFO   dataset: 2d
2022-09-29 14:38:32 INFO =====================================
2022-09-29 14:38:32 INFO loading dataset from: ./datasets/data/dsprites.npz
2022-09-29 14:38:38 INFO [dSprites stats]
2022-09-29 14:38:38 INFO   - images: torch.Size([737280, 1, 64, 64]) | min/max=(0.00, 1.00)
2022-09-29 14:38:38 INFO   - labels: torch.Size([737280, 3])
2022-09-29 14:38:38 INFO       labels[:, 0] min/max=(0.00, 1.00), min=0.50, std=0.34
2022-09-29 14:38:38 INFO       labels[:, 1] min/max=(0.00, 1.00), min=0.50, std=0.30
2022-09-29 14:38:38 INFO       labels[:, 2] min/max=(0.00, 1.00), min=0.50, std=0.30
2022-09-29 14:38:38 INFO CUDA is available
2022-09-29 14:38:39 INFO DuoVAE(
  (encoder_x): DataParallel(
    (module): EncoderX(
      (encoder): Sequential(
        (0): Conv2d(1, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
        (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU()
        (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
        (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (5): ReLU()
        (6): Conv2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
        (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (8): ReLU()
        (9): View()
        (10): Linear(in_features=2048, out_features=128, bias=True)
        (11): ReLU()
        (12): Linear(in_features=128, out_features=128, bias=True)
        (13): ReLU()
        (14): Linear(in_features=128, out_features=14, bias=True)
      )
    )
  )
  (decoder_x): DataParallel(
    (module): DecoderX(
      (decoder): Sequential(
        (0): Linear(in_features=7, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=2048, bias=True)
        (5): ReLU()
        (6): View()
        (7): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
        (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (9): ReLU()
        (10): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
        (11): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (12): ReLU()
        (13): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
        (14): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (15): ReLU()
        (16): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
    )
  )
  (encoder_y): DataParallel(
    (module): EncoderY(
      (encoder): ModuleList(
        (0): Sequential(
          (0): Linear(in_features=1, out_features=8, bias=True)
          (1): ReLU()
          (2): Linear(in_features=8, out_features=2, bias=True)
        )
        (1): Sequential(
          (0): Linear(in_features=1, out_features=8, bias=True)
          (1): ReLU()
          (2): Linear(in_features=8, out_features=2, bias=True)
        )
        (2): Sequential(
          (0): Linear(in_features=1, out_features=8, bias=True)
          (1): ReLU()
          (2): Linear(in_features=8, out_features=2, bias=True)
        )
      )
    )
  )
  (decoder_y): DataParallel(
    (module): DecoderY(
      (decoder): ModuleList(
        (0): Sequential(
          (0): Linear(in_features=1, out_features=8, bias=True)
          (1): ReLU()
          (2): Linear(in_features=8, out_features=1, bias=True)
          (3): Sigmoid()
        )
        (1): Sequential(
          (0): Linear(in_features=1, out_features=8, bias=True)
          (1): ReLU()
          (2): Linear(in_features=8, out_features=1, bias=True)
          (3): Sigmoid()
        )
        (2): Sequential(
          (0): Linear(in_features=1, out_features=8, bias=True)
          (1): ReLU()
          (2): Linear(in_features=8, out_features=1, bias=True)
          (3): Sigmoid()
        )
      )
    )
  )
)
2022-09-29 14:38:39 INFO Device=cuda:0, GPU Ids=[0]
2022-09-29 14:38:39 INFO Training on 737,280 number of data
2022-09-29 14:39:31 INFO epoch(1/100000) losses: x_recon(18.4674) y_recon(102.1072) y_recon2(218.0904) kl_div_z(0.1511) kl_div_w(35.4909) kl_div_w2(1.1046) 
2022-09-29 14:40:24 INFO epoch(2/100000) losses: x_recon(12.0548) y_recon(57.4203) y_recon2(201.3236) kl_div_z(0.0251) kl_div_w(38.1000) kl_div_w2(1.9658) 
2022-09-29 14:41:19 INFO epoch(3/100000) losses: x_recon(11.4686) y_recon(29.8835) y_recon2(171.6165) kl_div_z(0.0174) kl_div_w(32.2534) kl_div_w2(3.9451) 
2022-09-29 14:42:12 INFO epoch(4/100000) losses: x_recon(11.1914) y_recon(15.1199) y_recon2(116.8587) kl_div_z(0.0150) kl_div_w(20.3231) kl_div_w2(7.0093) 
2022-09-29 14:43:06 INFO epoch(5/100000) losses: x_recon(10.9932) y_recon(9.6563) y_recon2(67.7008) kl_div_z(0.0133) kl_div_w(12.3768) kl_div_w2(10.0873) 
2022-09-29 14:44:00 INFO epoch(6/100000) losses: x_recon(10.8183) y_recon(7.3917) y_recon2(39.3259) kl_div_z(0.0113) kl_div_w(8.5333) kl_div_w2(12.7065) 
2022-09-29 14:44:53 INFO epoch(7/100000) losses: x_recon(10.6698) y_recon(6.2164) y_recon2(23.5501) kl_div_z(0.0097) kl_div_w(6.3804) kl_div_w2(14.9419) 
2022-09-29 14:45:47 INFO epoch(8/100000) losses: x_recon(10.5428) y_recon(5.5118) y_recon2(16.1869) kl_div_z(0.0088) kl_div_w(5.1959) kl_div_w2(16.7190) 
2022-09-29 14:46:41 INFO epoch(9/100000) losses: x_recon(10.4500) y_recon(5.0829) y_recon2(12.5728) kl_div_z(0.0081) kl_div_w(4.5176) kl_div_w2(17.9784) 
2022-09-29 14:47:34 INFO epoch(10/100000) losses: x_recon(10.3780) y_recon(4.7399) y_recon2(10.5783) kl_div_z(0.0073) kl_div_w(4.0638) kl_div_w2(18.7384) 
2022-09-29 14:48:27 INFO epoch(11/100000) losses: x_recon(10.3284) y_recon(4.4539) y_recon2(9.4552) kl_div_z(0.0065) kl_div_w(3.7368) kl_div_w2(19.1144) 
2022-09-29 14:49:21 INFO epoch(12/100000) losses: x_recon(10.3011) y_recon(4.2919) y_recon2(8.7475) kl_div_z(0.0059) kl_div_w(3.5590) kl_div_w2(19.2558) 
2022-09-29 14:50:15 INFO epoch(13/100000) losses: x_recon(10.2831) y_recon(4.1409) y_recon2(8.2965) kl_div_z(0.0054) kl_div_w(3.3881) kl_div_w2(19.2558) 
2022-09-29 14:51:08 INFO epoch(14/100000) losses: x_recon(10.2661) y_recon(4.0596) y_recon2(7.9952) kl_div_z(0.0049) kl_div_w(3.2682) kl_div_w2(19.1678) 
2022-09-29 14:52:02 INFO epoch(15/100000) losses: x_recon(10.2632) y_recon(3.8801) y_recon2(7.6648) kl_div_z(0.0045) kl_div_w(3.1435) kl_div_w2(19.0574) 
2022-09-29 14:52:55 INFO epoch(16/100000) losses: x_recon(10.2513) y_recon(3.6566) y_recon2(7.3350) kl_div_z(0.0042) kl_div_w(3.0310) kl_div_w2(19.0249) 
2022-09-29 14:53:49 INFO epoch(17/100000) losses: x_recon(10.2444) y_recon(3.5313) y_recon2(7.1001) kl_div_z(0.0039) kl_div_w(2.9616) kl_div_w2(19.0077) 
2022-09-29 14:54:43 INFO epoch(18/100000) losses: x_recon(10.2379) y_recon(3.4324) y_recon2(6.9560) kl_div_z(0.0036) kl_div_w(2.8831) kl_div_w2(18.9722) 
2022-09-29 14:55:36 INFO epoch(19/100000) losses: x_recon(10.2300) y_recon(3.3701) y_recon2(6.8527) kl_div_z(0.0033) kl_div_w(2.8438) kl_div_w2(18.9416) 
2022-09-29 14:56:30 INFO epoch(20/100000) losses: x_recon(10.2262) y_recon(3.2915) y_recon2(6.7626) kl_div_z(0.0030) kl_div_w(2.7849) kl_div_w2(18.9092) 
2022-09-29 14:57:23 INFO epoch(21/100000) losses: x_recon(10.2190) y_recon(3.1418) y_recon2(6.5867) kl_div_z(0.0028) kl_div_w(2.7368) kl_div_w2(18.8911) 
2022-09-29 14:58:16 INFO epoch(22/100000) losses: x_recon(10.2098) y_recon(3.0369) y_recon2(6.4300) kl_div_z(0.0026) kl_div_w(2.6991) kl_div_w2(18.9312) 
2022-09-29 14:59:10 INFO epoch(23/100000) losses: x_recon(10.2044) y_recon(2.9663) y_recon2(6.3470) kl_div_z(0.0025) kl_div_w(2.6678) kl_div_w2(18.9377) 
2022-09-29 15:00:03 INFO epoch(24/100000) losses: x_recon(10.1986) y_recon(2.9067) y_recon2(6.2735) kl_div_z(0.0023) kl_div_w(2.6444) kl_div_w2(18.9614) 
2022-09-29 15:00:57 INFO epoch(25/100000) losses: x_recon(10.1901) y_recon(2.8465) y_recon2(6.1898) kl_div_z(0.0021) kl_div_w(2.6201) kl_div_w2(18.9921) 
2022-09-29 15:01:50 INFO epoch(26/100000) losses: x_recon(10.1800) y_recon(2.7772) y_recon2(6.1328) kl_div_z(0.0020) kl_div_w(2.5815) kl_div_w2(19.0152) 
2022-09-29 15:02:44 INFO epoch(27/100000) losses: x_recon(10.1813) y_recon(2.7595) y_recon2(6.0891) kl_div_z(0.0019) kl_div_w(2.5944) kl_div_w2(19.0226) 
2022-09-29 15:03:37 INFO epoch(28/100000) losses: x_recon(10.1739) y_recon(2.7139) y_recon2(6.0587) kl_div_z(0.0018) kl_div_w(2.5637) kl_div_w2(19.0502) 
2022-09-29 15:04:30 INFO epoch(29/100000) losses: x_recon(10.1715) y_recon(2.6885) y_recon2(6.0358) kl_div_z(0.0017) kl_div_w(2.5573) kl_div_w2(19.0644) 
2022-09-29 15:04:30 INFO train recontructions saved: output/duovae/2d/log/recon_30.png
2022-09-29 15:05:23 INFO epoch(30/100000) losses: x_recon(10.1663) y_recon(2.6569) y_recon2(6.0099) kl_div_z(0.0016) kl_div_w(2.5410) kl_div_w2(19.0721) 
2022-09-29 15:05:23 INFO train losses saved: output/duovae/2d/log/losses.json, output/duovae/2d/log/losses.png
2022-09-29 15:05:23 INFO model saved: output/duovae/2d/model/00030
2022-09-29 15:05:24 INFO y-traverse saved: None
2022-09-29 15:05:34 INFO MI score saved: output/duovae/2d/visualization/MI_duovae_00030.png
2022-09-29 15:06:24 INFO epoch(31/100000) losses: x_recon(10.1669) y_recon(2.6426) y_recon2(5.9972) kl_div_z(0.0015) kl_div_w(2.5358) kl_div_w2(19.0766) 
2022-09-29 15:07:17 INFO epoch(32/100000) losses: x_recon(10.1640) y_recon(2.6318) y_recon2(5.9908) kl_div_z(0.0014) kl_div_w(2.5353) kl_div_w2(19.0835) 
2022-09-29 15:08:11 INFO epoch(33/100000) losses: x_recon(10.1601) y_recon(2.6206) y_recon2(5.9770) kl_div_z(0.0013) kl_div_w(2.5304) kl_div_w2(19.0934) 
2022-09-29 15:09:04 INFO epoch(34/100000) losses: x_recon(10.1575) y_recon(2.6040) y_recon2(5.9717) kl_div_z(0.0012) kl_div_w(2.5245) kl_div_w2(19.0880) 
2022-09-29 15:09:57 INFO epoch(35/100000) losses: x_recon(10.1574) y_recon(2.5815) y_recon2(5.9692) kl_div_z(0.0012) kl_div_w(2.5055) kl_div_w2(19.1002) 
2022-09-29 15:10:50 INFO epoch(36/100000) losses: x_recon(10.1492) y_recon(2.5731) y_recon2(5.9545) kl_div_z(0.0012) kl_div_w(2.4991) kl_div_w2(19.1039) 
2022-09-29 15:11:43 INFO epoch(37/100000) losses: x_recon(10.1515) y_recon(2.5610) y_recon2(5.9490) kl_div_z(0.0011) kl_div_w(2.4942) kl_div_w2(19.0974) 
2022-09-29 15:12:36 INFO epoch(38/100000) losses: x_recon(10.1483) y_recon(2.5224) y_recon2(5.8842) kl_div_z(0.0010) kl_div_w(2.4868) kl_div_w2(19.1130) 
